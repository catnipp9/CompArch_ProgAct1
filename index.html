<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number System Converter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-color: #f0f0f0;
            --lavender: #D7A8FF;
            --soft-purple: #5C258D;
            --vibrant-pink: #FF00A2;
            --deep-purple: #1a0033;
            --shadow-color: rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #1a0033, #3a0050, #1a0033);
            color: var(--text-color);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, rgba(215, 168, 255, 0.2) 0%, transparent 40%),
                                 radial-gradient(circle, rgba(255, 0, 162, 0.2) 0%, transparent 40%);
            background-size: 50% 50%, 50% 50%;
            background-position: top left, bottom right;
            pointer-events: none;
            z-index: -1;
            animation: move-bg 15s infinite alternate;
        }

        @keyframes move-bg {
            from { background-position: top left, bottom right; }
            to { background-position: bottom right, top left; }
        }

        .container {
            max-width: 900px;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .main-content {
            display: flex;
            gap: 20px;
            flex-grow: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .title {
            font-size: clamp(2rem, 5vw, 2.5rem);
            font-weight: 700;
            text-shadow: 0 0 15px var(--lavender), 0 0 25px var(--lavender);
            margin-bottom: 5px;
            color: var(--lavender);
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
            color: #ccc;
        }

        nav {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 4px 16px var(--shadow-color);
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            height: fit-content;
        }

        nav .btn {
            background: transparent;
            border: none;
            color: var(--text-color);
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 10px;
            text-align: left;
        }
        
        nav .btn.active {
            background: rgba(215, 168, 255, 0.2);
            font-weight: 700;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2), 0 0 10px var(--lavender);
            animation: pulse-lavender 1.5s infinite alternate;
        }

        nav .btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.05);
            color: var(--lavender);
            transform: scale(1.05);
        }

        .glass-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px var(--shadow-color);
            padding: 30px;
            flex-grow: 1;
            display: none;
            flex-direction: column;
            gap: 20px;
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glass-card.active {
            display: flex;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            opacity: 0.9;
            color: var(--lavender);
        }

        .input, .select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            color: var(--text-color);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .input:focus, .select:focus {
            outline: none;
            background: rgba(0, 0, 0, 0.6);
            border-color: var(--lavender);
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.4), 0 0 10px var(--lavender);
        }
        
        .select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23D7A8FF' width='18px' height='18px'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            padding-right: 40px;
        }
        
        .btn.submit {
            background: linear-gradient(90deg, var(--lavender), var(--vibrant-pink));
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(215, 168, 255, 0.4), 0 3px 10px rgba(255, 0, 162, 0.4);
            width: 100%;
            margin-top: 10px;
        }

        .btn.submit:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 15px rgba(215, 168, 255, 0.6), 0 6px 15px rgba(255, 0, 162, 0.6);
            filter: brightness(1.1);
        }
        
        .btn.submit:active {
            transform: translateY(0);
        }

        .result {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            min-height: 60px;
            font-weight: 500;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
            word-break: break-all;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-label {
            font-size: 0.9rem;
            opacity: 0.8;
            color: var(--lavender);
        }

        .result-value {
            font-size: 1.1rem;
            font-weight: 700;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
            flex-grow: 1;
        }

        .result .icon {
            font-size: 1.5rem;
            line-height: 1;
        }
        
        .result .icon.success {
            color: #A8FFD7;
            text-shadow: 0 0 10px #A8FFD7;
            animation: neon-pulse-green 1s ease-in-out infinite alternate;
        }

        .result .icon.error {
            color: var(--vibrant-pink);
            text-shadow: 0 0 10px var(--vibrant-pink);
            animation: shake 0.5s;
        }
        
        .add-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .error {
            border-color: var(--vibrant-pink) !important;
            box-shadow: 0 0 10px var(--vibrant-pink) !important;
        }

        @media (max-width: 600px) {
            .main-content {
                flex-direction: column;
            }
        }
        
        @keyframes pulse-lavender {
            from { box-shadow: 0 0 5px var(--lavender), inset 0 2px 5px rgba(0, 0, 0, 0.2); }
            to { box-shadow: 0 0 20px var(--lavender), inset 0 2px 5px rgba(0, 0, 0, 0.2); }
        }

        @keyframes neon-pulse-green {
            from { text-shadow: 0 0 5px #A8FFD7; }
            to { text-shadow: 0 0 15px #A8FFD7, 0 0 25px #A8FFD7; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <p class="subtitle">CPE463 - Programming Activity 1</p>
            <h1 class="title">Number System Converter</h1>
            <p class="author">Jamel P. Hadjirasul   BSCPE - 4</p>
        </div>

        <div class="main-content">
            <nav>
                <button class="btn active" data-target="decimal-card">From Decimal</button>
                <button class="btn" data-target="to-decimal-card">To Decimal</button>
                <button class="btn" data-target="add-card">Add Numbers</button>
                <button class="btn" data-target="encode-card">Encode</button>
                <button class="btn" data-target="decode-card">Decode</button>
                <button class="btn" data-target="exit-card">Exit</button>
            </nav>
            
            <section id="decimal-card" class="glass-card active">
                <h2>Convert Decimal to Binary/Octal/Hex</h2>
                <div class="input-group">
                    <label for="decimal-input" class="label">Enter Decimal Number:</label>
                    <input type="text" id="decimal-input" class="input" placeholder="e.g., 15.5 or 15">
                </div>
                <button class="btn submit" onclick="convertFromDecimal()">Convert</button>
                <div class="result" id="decimal-result">
                    <div class="result-label">Results will appear here...</div>
                </div>
            </section>

            <section id="to-decimal-card" class="glass-card">
                <h2>Convert Binary/Octal/Hex to Decimal</h2>
                <div class="input-group">
                    <label for="base-select" class="label">Select Base:</label>
                    <select id="base-select" class="select">
                        <option value="2">Binary (Base 2)</option>
                        <option value="8">Octal (Base 8)</option>
                        <option value="16">Hexadecimal (Base 16)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="base-input" class="label">Enter Number:</label>
                    <input type="text" id="base-input" class="input" placeholder="e.g., 1111.1 (for binary)">
                </div>
                <button class="btn submit" onclick="convertToDecimal()">Convert to Decimal</button>
                <div class="result" id="base-result">
                    <div class="result-label">Results will appear here...</div>
                </div>
            </section>

            <section id="add-card" class="glass-card">
                <h2>Add Two Numbers in Any Base</h2>
                <div class="add-inputs">
                    <div class="input-group">
                        <label for="add-num1" class="label">First Number:</label>
                        <input type="text" id="add-num1" class="input" placeholder="e.g., 10.5">
                    </div>
                    <div class="input-group">
                        <label for="add-base1" class="label">Its Base:</label>
                        <select id="add-base1" class="select">
                            <option value="2">Binary</option>
                            <option value="8">Octal</option>
                            <option value="10">Decimal</option>
                            <option value="16">Hexadecimal</option>
                        </select>
                    </div>
                </div>
                <div class="add-inputs">
                    <div class="input-group">
                        <label for="add-num2" class="label">Second Number:</label>
                        <input type="text" id="add-num2" class="input" placeholder="e.g., 20.25">
                    </div>
                    <div class="input-group">
                        <label for="add-base2" class="label">Its Base:</label>
                        <select id="add-base2" class="select">
                            <option value="2">Binary</option>
                            <option value="8">Octal</option>
                            <option value="10">Decimal</option>
                            <option value="16">Hexadecimal</option>
                        </select>
                    </div>
                </div>
                <button class="btn submit" onclick="addNumbers()">Calculate</button>
                <div class="result" id="add-result">
                    <div class="result-label">Results will appear here...</div>
                </div>
            </section>
            
            <section id="encode-card" class="glass-card">
                <h2>Secret Code Translator (Encode)</h2>
                <div class="input-group">
                    <label for="encode-message" class="label">Enter message:</label>
                    <input type="text" id="encode-message" class="input" placeholder="e.g., HELLO">
                </div>
                <div class="input-group">
                    <label for="encode-key" class="label">Enter secret key (decimal):</label>
                    <input type="number" id="encode-key" class="input" placeholder="e.g., 5">
                </div>
                <button class="btn submit" onclick="encodeMessage()">Encode Message</button>
                <div class="result" id="encode-result">
                    <div class="result-label">Results will appear here...</div>
                </div>
            </section>
            
            <section id="decode-card" class="glass-card">
                <h2>Secret Code Translator (Decode)</h2>
                <div class="input-group">
                    <label for="decode-key" class="label">Enter secret key (decimal):</label>
                    <input type="number" id="decode-key" class="input" placeholder="e.g., 5">
                </div>
                <button class="btn submit" onclick="decodeMessage()">Decode Message</button>
                <div class="result" id="decode-result">
                    <div class="result-label">Results will appear here...</div>
                </div>
            </section>
            
            <section id="exit-card" class="glass-card">
                <h2>Exit Program</h2>
                <p>Click the button below to end the session.</p>
                <button class="btn submit" onclick="exitProgram()">Exit Program</button>
                <div class="result" id="exit-result">
                    <div class="result-label">Exiting program. Goodbye!</div>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Global variable to store encoded values
        let encodedValues = [];

        document.addEventListener('DOMContentLoaded', () => {
            const navButtons = document.querySelectorAll('nav .btn');
            const sections = document.querySelectorAll('.glass-card');

            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    sections.forEach(s => s.classList.remove('active'));
                    navButtons.forEach(b => b.classList.remove('active'));
                    const targetId = button.getAttribute('data-target');
                    if (targetId === 'exit-card') {
                        exitProgram();
                    } else {
                        document.getElementById(targetId).classList.add('active');
                        button.classList.add('active');
                    }
                });
            });
        });

        // Helper function to convert a fractional part of a number from a given base to decimal
        function fracToDecimal(fracPart, base) {
            let decimalValue = 0;
            const hexMap = { 'A': 10, 'B': 11, 'C': 12, 'D': 13, 'E': 14, 'F': 15 };
            
            for (let i = 0; i < fracPart.length; i++) {
                let digit = fracPart[i].toUpperCase();
                let value = base === 16 ? (hexMap[digit] || parseInt(digit)) : parseInt(digit);
                decimalValue += value * Math.pow(base, -(i + 1));
            }
            return decimalValue;
        }

        // Helper function to convert a decimal fractional part to a given base
        function decimalFracToBase(fracPart, base) {
            let result = '';
            const precision = 10; // Set a reasonable precision to avoid infinite loops
            let fractional = parseFloat('0.' + fracPart);
            const hexDigits = '0123456789ABCDEF';

            for (let i = 0; i < precision; i++) {
                if (fractional === 0) break;
                fractional *= base;
                let integerPart = Math.floor(fractional);
                result += hexDigits[integerPart];
                fractional -= integerPart;
            }
            return result;
        }

        // Modified isValidNumber to allow a single decimal point
        function isValidNumber(num, base) {
            if (!num || num.trim() === '') return false;
            
            const cleanNum = num.trim().toUpperCase();
            // Regex now includes an optional decimal point and more characters
            const validPatterns = {
                2: /^[01]+(\.[01]+)?$/,
                8: /^[0-7]+(\.[0-7]+)?$/,
                10: /^[0-9]+(\.[0-9]+)?$/,
                16: /^[0-9A-F]+(\.[0-9A-F]+)?$/
            };
            
            return validPatterns[base] ? validPatterns[base].test(cleanNum) : false;
        }

        function convertFromDecimal() {
            const input = document.getElementById('decimal-input');
            const result = document.getElementById('decimal-result');
            const value = input.value.trim();
            input.classList.remove('error');
            
            if (!isValidNumber(value, 10)) {
                input.classList.add('error');
                result.innerHTML = `<span class="icon error">❌</span> <div class="result-label error">Invalid decimal number!</div>`;
                return;
            }
            
            const [intPart, fracPart = ''] = value.split('.');
            const decimalInt = parseInt(intPart, 10);
            
            // Convert integer part
            const binaryInt = decimalInt.toString(2);
            const octalInt = decimalInt.toString(8);
            const hexInt = decimalInt.toString(16).toUpperCase();

            // Convert fractional part
            const binaryFrac = decimalFracToBase(fracPart, 2);
            const octalFrac = decimalFracToBase(fracPart, 8);
            const hexFrac = decimalFracToBase(fracPart, 16);

            const binary = binaryInt + (binaryFrac ? '.' + binaryFrac : '');
            const octal = octalInt + (octalFrac ? '.' + octalFrac : '');
            const hex = hexInt + (hexFrac ? '.' + hexFrac : '');
            
            result.innerHTML = `
                <span class="icon success">✅</span>
                <div class="result-value">
                    <div class="result-label">CONVERSION RESULTS:</div>
                    Binary: ${binary}<br>
                    Octal: ${octal}<br>
                    Hexadecimal: ${hex}
                </div>
            `;
        }

        function convertToDecimal() {
            const baseSelect = document.getElementById('base-select');
            const input = document.getElementById('base-input');
            const result = document.getElementById('base-result');
            const base = parseInt(baseSelect.value);
            const value = input.value.trim();
            input.classList.remove('error');
            
            if (!isValidNumber(value, base)) {
                input.classList.add('error');
                const baseName = base === 2 ? 'binary' : base === 8 ? 'octal' : 'hexadecimal';
                result.innerHTML = `<span class="icon error">❌</span> <div class="result-label error">Invalid ${baseName} number!</div>`;
                return;
            }
            
            const [intPart, fracPart = ''] = value.split('.');
            
            // Convert integer part
            const decimalInt = parseInt(intPart, base);
            
            // Convert fractional part
            const decimalFrac = fracToDecimal(fracPart, base);
            
            const decimal = decimalInt + decimalFrac;

            const baseName = { 2: 'Binary', 8: 'Octal', 16: 'Hexadecimal' }[base];
            
            result.innerHTML = `
                <span class="icon success">✅</span>
                <div class="result-value">
                    <div class="result-label">CONVERSION RESULT:</div>
                    ${baseName} ${value} = Decimal ${decimal.toFixed(10).replace(/\.?0+$/, '')}
                </div>
            `;
        }

        function addNumbers() {
            const num1Input = document.getElementById('add-num1');
            const base1Select = document.getElementById('add-base1');
            const num2Input = document.getElementById('add-num2');
            const base2Select = document.getElementById('add-base2');
            const result = document.getElementById('add-result');

            const num1 = num1Input.value.trim();
            const base1 = parseInt(base1Select.value);
            const num2 = num2Input.value.trim();
            const base2 = parseInt(base2Select.value);
            
            num1Input.classList.remove('error');
            num2Input.classList.remove('error');

            let hasError = false;
            
            if (!isValidNumber(num1, base1)) {
                num1Input.classList.add('error');
                hasError = true;
            }
            
            if (!isValidNumber(num2, base2)) {
                num2Input.classList.add('error');
                hasError = true;
            }

            if (hasError) {
                result.innerHTML = `<span class="icon error">❌</span> <div class="result-label error">Please enter valid numbers and select their bases!</div>`;
                return;
            }

            // Convert both numbers to decimal for addition
            const [num1Int, num1Frac = ''] = num1.split('.');
            const [num2Int, num2Frac = ''] = num2.split('.');
            
            const decimal1 = parseInt(num1Int, base1) + fracToDecimal(num1Frac, base1);
            const decimal2 = parseInt(num2Int, base2) + fracToDecimal(num2Frac, base2);
            
            const sum = decimal1 + decimal2;
            const [sumInt, sumFrac] = sum.toString().split('.');

            // Convert sum back to other bases, handling both integer and fractional parts
            const binaryResult = parseInt(sumInt, 10).toString(2) + (sumFrac ? '.' + decimalFracToBase(sumFrac, 2) : '');
            const octalResult = parseInt(sumInt, 10).toString(8) + (sumFrac ? '.' + decimalFracToBase(sumFrac, 8) : '');
            const hexResult = parseInt(sumInt, 10).toString(16).toUpperCase() + (sumFrac ? '.' + decimalFracToBase(sumFrac, 16) : '');

            result.innerHTML = `
                <span class="icon success">✅</span>
                <div class="result-value">
                    <div class="result-label">RESULTS OF ADDITION:</div>
                    Decimal: ${sum}<br>
                    Binary: ${binaryResult}<br>
                    Octal: ${octalResult}<br>
                    Hexadecimal: ${hexResult}
                </div>
            `;
        }
        
        function encodeMessage() {
            const messageInput = document.getElementById('encode-message');
            const keyInput = document.getElementById('encode-key');
            const result = document.getElementById('encode-result');
            const message = messageInput.value.trim();
            const key = parseInt(keyInput.value, 10);
            messageInput.classList.remove('error');
            keyInput.classList.remove('error');
            
            if (message === '') {
                messageInput.classList.add('error');
                result.innerHTML = `<span class="icon error">❌</span> <div class="result-label error">Please enter a message!</div>`;
                return;
            }
            
            if (isNaN(key)) {
                keyInput.classList.add('error');
                result.innerHTML = `<span class="icon error">❌</span> <div class="result-label error">Please enter a valid decimal key!</div>`;
                return;
            }
            
            const decimalValues = [];
            const hexValues = [];
            
            for (let i = 0; i < message.length; i++) {
                const asciiValue = message.charCodeAt(i);
                const encodedValue = asciiValue + key;
                decimalValues.push(encodedValue);
                hexValues.push(encodedValue.toString(16).toUpperCase());
            }

            // Store encoded decimal values globally
            encodedValues = decimalValues;
            
            result.innerHTML = `
                <span class="icon success">✅</span>
                <div class="result-value">
                    <div class="result-label">ENCODING RESULTS:</div>
                    Encoded (decimal values): [${decimalValues.join(', ')}]<br>
                    Encoded (hex values): ['${hexValues.join("', '")}']
                </div>
            `;
        }
        
        function decodeMessage() {
            const keyInput = document.getElementById('decode-key');
            const result = document.getElementById('decode-result');
            
            // Check if there are values to decode
            if (encodedValues.length === 0) {
                result.innerHTML = `<span class="icon error">❌</span> <div class="result-label error">No encoded values found. Please encode a message first!</div>`;
                return;
            }

            const key = parseInt(keyInput.value, 10);
            keyInput.classList.remove('error');
            
            if (isNaN(key)) {
                keyInput.classList.add('error');
                result.innerHTML = `<span class="icon error">❌</span> <div class="result-label error">Please enter a valid decimal key!</div>`;
                return;
            }
            
            let decodedMessage = '';
            for (const value of encodedValues) {
                const decodedAscii = value - key;
                decodedMessage += String.fromCharCode(decodedAscii);
            }
            
            result.innerHTML = `
                <span class="icon success">✅</span>
                <div class="result-value">
                    <div class="result-label">DECODING RESULT:</div>
                    Decoded Message: ${decodedMessage}
                </div>
            `;
        }
        
        function exitProgram() {
            const container = document.querySelector('.container');
            container.innerHTML = `
                <div class="glass-card active" style="text-align: center;">
                    <h2>Exiting Program</h2>
                    <p style="font-size: 1.5rem; margin-top: 20px;">Goodbye! 👋</p>
                </div>
            `;
        }

        // Add enter key support
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const activeCard = document.querySelector('.glass-card.active');
                if (activeCard) {
                    const submitButton = activeCard.querySelector('.btn.submit');
                    if (submitButton) {
                        submitButton.click();
                    }
                }
            }
        });
    </script>
</body>
</html>
